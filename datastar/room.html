<!doctype html>
{{- define `message` -}}
<div class="message">
  <p class="content">{{- .Content -}}</p>
</div>
{{- end -}}
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title data-text="$title">{{ .RoomName }}</title>
    <script type="module" src="{{ .DataStarPath }}"></script>
    <style type="text/css">
      @keyframes fade {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }

      ::view-transition-old(root),
      ::view-transition-new(root) {
        animation-duration: 2.5s;
      }

      ::view-transition-old(foo) {
        animation: fade 2.2s linear forwards;
      }

      ::view-transition-new(foo) {
        animation: fade 2.3s linear reverse;
      }

      body {
        background-color: red;
      }
    </style>
  </head>
  <body
    data-store="{title: 'test title'}"
    data-on-load="$get('{{ .MessageSourcePath }}?roomName={{ urlencode .RoomName }}')"
    data-view-transition="foo"
  >
    <h1>Chat: {{ .RoomName }}</h1>
    <div id="question">Wazzup???</div>
    <div data-text="'title: ' + $title"></div>
    <hr />
    <form
      action="{{ .MessageSendPath }}"
      method="post"
      onsubmit="return false;"
    >
      <input data-model="input" type="text" />
      <div data-text="$input">
        I will get replaced with the contents of the input signal
      </div>
      <button
        type="button"
        data-on-click="$post('{{ .MessageSendPath }}?roomName={{ urlencode .RoomName }}&content='+encodeURIComponent($input)) && ($input = '')"
      >
        Send
      </button>
      {{ .MessageSendPath }}
    </form>
  </body>
</html>
